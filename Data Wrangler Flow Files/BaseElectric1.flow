{
  "metadata": {
    "version": 1,
    "disable_limits": false
  },
  "nodes": [
    {
      "node_id": "52fc189d-64fb-492e-ab9a-5ed8dd6d7c5f",
      "type": "SOURCE",
      "operator": "sagemaker.s3_source_0.1",
      "parameters": {
        "dataset_definition": {
          "__typename": "S3CreateDatasetDefinitionOutput",
          "datasetSourceType": "S3",
          "name": "census_pop.parquet.gzip",
          "description": null,
          "s3ExecutionContext": {
            "__typename": "S3ExecutionContext",
            "s3Uri": "s3://sagemaker-us-east-1-651000550833/Clean_Data/census_pop.parquet.gzip",
            "s3ContentType": "parquet",
            "s3HasHeader": true,
            "s3FieldDelimiter": ",",
            "s3DirIncludesNested": false,
            "s3AddsFilenameColumn": false
          }
        }
      },
      "inputs": [],
      "outputs": [
        {
          "name": "default",
          "sampling": {
            "sampling_method": "sample_by_limit",
            "limit_rows": 50000
          }
        }
      ]
    },
    {
      "node_id": "aa41c53e-62be-4586-a734-428a20cdc316",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.infer_and_cast_type_0.1",
      "parameters": {},
      "trained_parameters": {
        "schema": {
          "weather_station": "string",
          "Zip": "long",
          "Est": "long",
          "MOE": "long",
          "Year": "long"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "52fc189d-64fb-492e-ab9a-5ed8dd6d7c5f",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "32b234e4-ed2c-4551-9216-90eab551f7f0",
      "type": "SOURCE",
      "operator": "sagemaker.s3_source_0.1",
      "parameters": {
        "dataset_definition": {
          "__typename": "S3CreateDatasetDefinitionOutput",
          "datasetSourceType": "S3",
          "name": "vehicle_registration.parquet.gzip",
          "description": null,
          "s3ExecutionContext": {
            "__typename": "S3ExecutionContext",
            "s3Uri": "s3://sagemaker-us-east-1-651000550833/Clean_Data/vehicle_registration.parquet.gzip",
            "s3ContentType": "parquet",
            "s3HasHeader": true,
            "s3FieldDelimiter": ",",
            "s3DirIncludesNested": false,
            "s3AddsFilenameColumn": false
          }
        }
      },
      "inputs": [],
      "outputs": [
        {
          "name": "default",
          "sampling": {
            "sampling_method": "sample_by_limit",
            "limit_rows": 50000
          }
        }
      ]
    },
    {
      "node_id": "4e361428-604f-43cb-a090-5d54d99ad7ad",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.infer_and_cast_type_0.1",
      "parameters": {},
      "trained_parameters": {
        "schema": {
          "Fuel": "string",
          "Year": "long",
          "ZIP": "long",
          "#_vehicles": "long"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "32b234e4-ed2c-4551-9216-90eab551f7f0",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "6b665194-2666-4338-b40d-c62ca97c131f",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.manage_columns_0.1",
      "parameters": {
        "operator": "Drop column",
        "drop_column_parameters": {
          "column_to_drop": [
            "MOE"
          ]
        }
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "aa41c53e-62be-4586-a734-428a20cdc316",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "37044a22-c771-4570-b67a-518a7f293811",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.join_multi_keys_0.1",
      "name": "Vehicles_&_Pop",
      "parameters": {
        "join_keys": [
          {
            "left": "Zip",
            "right": "ZIP"
          },
          {
            "left": "Year",
            "right": "Year"
          }
        ],
        "join_type": "inner"
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "6b665194-2666-4338-b40d-c62ca97c131f",
          "output_name": "default"
        },
        {
          "name": "df",
          "node_id": "4e361428-604f-43cb-a090-5d54d99ad7ad",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "5f31eb71-47d5-4bcf-8929-1dbab26fc50d",
      "type": "SOURCE",
      "operator": "sagemaker.s3_source_0.1",
      "parameters": {
        "dataset_definition": {
          "__typename": "S3CreateDatasetDefinitionOutput",
          "datasetSourceType": "S3",
          "name": "sdge.parquet.gzip",
          "description": null,
          "s3ExecutionContext": {
            "__typename": "S3ExecutionContext",
            "s3Uri": "s3://sagemaker-us-east-1-651000550833/Clean_Data/sdge.parquet.gzip",
            "s3ContentType": "parquet",
            "s3HasHeader": true,
            "s3FieldDelimiter": ",",
            "s3DirIncludesNested": false,
            "s3AddsFilenameColumn": false
          }
        }
      },
      "inputs": [],
      "outputs": [
        {
          "name": "default",
          "sampling": {
            "sampling_method": "sample_by_limit",
            "limit_rows": 50000
          }
        }
      ]
    },
    {
      "node_id": "8cb85d9b-e014-4f2c-a608-4f018ced7154",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.infer_and_cast_type_0.1",
      "parameters": {},
      "trained_parameters": {
        "schema": {
          "ZipCode": "long",
          "Year": "long",
          "Month": "long",
          "TotalCustomers_gas": "long",
          "TotalTherms": "long",
          "AverageTherms": "long",
          "TotalCustomers_elect": "long",
          "TotalkWh": "long",
          "AveragekWh": "long"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "5f31eb71-47d5-4bcf-8929-1dbab26fc50d",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "3a09a41c-1e62-4c34-bf8c-8aab18d5e63f",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.manage_columns_0.1",
      "parameters": {
        "operator": "Drop column",
        "drop_column_parameters": {
          "column_to_drop": [
            "AveragekWh"
          ]
        }
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "8cb85d9b-e014-4f2c-a608-4f018ced7154",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "27845b5c-5fd6-42c5-91fc-a5034c25f19a",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.join_multi_keys_0.1",
      "name": "Census_CarReg_SDGE",
      "parameters": {
        "join_keys": [
          {
            "left": "ZipCode",
            "right": "Zip"
          },
          {
            "left": "Year",
            "right": "Year"
          }
        ],
        "join_type": "inner"
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "3a09a41c-1e62-4c34-bf8c-8aab18d5e63f",
          "output_name": "default"
        },
        {
          "name": "df",
          "node_id": "37044a22-c771-4570-b67a-518a7f293811",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "ba776245-d71b-468e-be20-452aa64a0a09",
      "type": "SOURCE",
      "operator": "sagemaker.s3_source_0.1",
      "parameters": {
        "dataset_definition": {
          "__typename": "S3CreateDatasetDefinitionOutput",
          "datasetSourceType": "S3",
          "name": "weather.parquet.gzip",
          "description": null,
          "s3ExecutionContext": {
            "__typename": "S3ExecutionContext",
            "s3Uri": "s3://sagemaker-us-east-1-651000550833/Clean_Data/weather.parquet.gzip",
            "s3ContentType": "parquet",
            "s3HasHeader": true,
            "s3FieldDelimiter": ",",
            "s3DirIncludesNested": false,
            "s3AddsFilenameColumn": false
          }
        }
      },
      "inputs": [],
      "outputs": [
        {
          "name": "default",
          "sampling": {
            "sampling_method": "sample_by_limit",
            "limit_rows": 50000
          }
        }
      ]
    },
    {
      "node_id": "9dabf850-26fe-4a5e-9c09-0c0a0a89ed4b",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.infer_and_cast_type_0.1",
      "parameters": {},
      "trained_parameters": {
        "schema": {
          "location": "string",
          "Year": "long",
          "Month": "long",
          "Low": "long",
          "High": "long",
          "AvgHigh": "float",
          "AvgLow": "float",
          "Full_date": "datetime"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "ba776245-d71b-468e-be20-452aa64a0a09",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "3ad2a709-e414-44bd-bce1-1576b67d4f5d",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.manage_columns_0.1",
      "parameters": {
        "operator": "Drop column",
        "drop_column_parameters": {
          "column_to_drop": [
            "Full_date"
          ]
        }
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "9dabf850-26fe-4a5e-9c09-0c0a0a89ed4b",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "0fdebf07-9285-48cb-bf32-21a91dc25915",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.join_multi_keys_0.1",
      "name": "Great_Combine",
      "parameters": {
        "join_keys": [
          {
            "left": "location",
            "right": "weather_station"
          },
          {
            "left": "Year",
            "right": "Year"
          },
          {
            "left": "Month",
            "right": "Month"
          }
        ],
        "join_type": "inner"
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "3ad2a709-e414-44bd-bce1-1576b67d4f5d",
          "output_name": "default"
        },
        {
          "name": "df",
          "node_id": "27845b5c-5fd6-42c5-91fc-a5034c25f19a",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "dd53ab54-8410-4d8c-9e49-f50497e10859",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.manage_columns_0.1",
      "parameters": {
        "operator": "Drop column",
        "drop_column_parameters": {
          "column_to_drop": [
            "location",
            "Month",
            "Year",
            "ZipCode"
          ]
        }
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "0fdebf07-9285-48cb-bf32-21a91dc25915",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "0b68c2b2-7754-4417-8d62-796c1820956f",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.manage_columns_0.1",
      "parameters": {
        "operator": "Rename column",
        "rename_column_parameters": {
          "input_column": "Est",
          "new_name": "Est_Pop"
        },
        "drop_column_parameters": {}
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "dd53ab54-8410-4d8c-9e49-f50497e10859",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    }
  ]
}